---
title: "IntersectionObserver ã‚’ä½¿ç”¨ã—ã¦è¦ç´ ã®èƒŒæ™¯è‰²ã‚’å¤‰æ›´ã™ã‚‹"
emoji: "ğŸ’­"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["JavaScript"]
published: false
---
## ç›®çš„:IntersectionObserver APIã®ä½¿ç”¨æ–¹æ³•ã‚’å­¦ã¶

è¦ç´ ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«å…¥ã£ãŸã¨ãã«ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

### èª²é¡Œè©³ç´°

- ä¸‹è¨˜ã®HTMLã§ã€.target-element ã‚¯ãƒ©ã‚¹ã‚’æŒã¤è¦ç´ ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«å…¥ã£ãŸã¨ãã«èƒŒæ™¯è‰²ãŒç·‘è‰²ã«å¤‰ã‚ã‚‹ã‚ˆã†ã«ã€IntersectionObserverã‚’ä½¿ç”¨ã—ã¦JavaScriptã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®ãƒ’ãƒ³ãƒˆã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

1. IntersectionObserverã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã¦ã€ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«å¯¾ã—ã¦ç›¸å¯¾çš„ã«ç›£è¦–ã™ã‚‹ã€‚
2. è¦ç´ ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«å…¥ã£ãŸã¨ãã«ã€entry.isIntersectingãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
3. ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«å…¥ã£ãŸè¦ç´ ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã€‚

- å‚è€ƒæ–‡çŒ®

- [MDN Web Docs: Intersection Observer API](https://developer.mozilla.org/ja/docs/Web/API/Intersection_Observer_API)
- [w3 Intersection Observer](https://www.w3.org/TR/intersection-observer/)

```html
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IntersectionObserver èª²é¡Œ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .container {
            height: 200vh;
            /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã®é«˜ã• */
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .target-element {
            width: 200px;
            height: 200px;
            background-color: lightgray;
            margin: 50px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .target-margin {
            width: 200px;
            height: 200px;
            background-color: lightgray;
            margin: 50px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="target-margin"></div>
        <div class="target-margin"></div>
        <div class="target-element">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</div>
        <div class="target-element">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</div>
        <div class="target-element">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</div>
    </div>
    <script src="script.js"></script>
</body>

</html>

```

### javascript

```javascript
document.addEventListener('DOMContentLoaded', function () {
    var options = {
        root: null, // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«å¯¾ã—ã¦ç›¸å¯¾çš„
        rootMargin: '0px',
        threshold: 0.5 // 60%ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«å…¥ã£ãŸã¨ãã«ãƒˆãƒªã‚¬ãƒ¼
    };
    var observer = new IntersectionObserver(function (entries, observer) {
        entries.forEach(function (entry) {
            if (entry.isIntersecting) {
                entry.target.style.backgroundColor = 'green';
                // ä¸€åº¦ã ã‘å¤‰æ›´ã—ãŸã„å ´åˆã¯æ¬¡ã®è¡Œã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã—ã¦ãã ã•ã„
                // observer.unobserve(entry.target);
            }
            else {
                entry.target.style.backgroundColor = 'lightgray';
            }
        });
    }, options);
    // ç›£è¦–ã™ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¦ç´ ã‚’é¸æŠ
    var targets = document.querySelectorAll('.target-element');
    targets.forEach(function (target) {
        observer.observe(target);
    });
});
```
